<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>D — Denial of Service | STRIDE IT</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="index.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
  </head>

  <body>
    <!-- Topbar -->
    <div class="topbar sticky-top">
      <div
        class="container py-3 d-flex justify-content-between align-items-center"
      >
        <div class="fw-semibold">
          <a href="../index.html" class="brand-link">STRIDE IT</a>
        </div>

        <div class="d-flex gap-2 align-items-center">
          <span class="badge badge-soft rounded-pill" id="letterScore"
            >D: 0/3</span
          >
          <span class="badge badge-soft rounded-pill" id="totalScore"
            >Total: 0/18</span
          >
        </div>
      </div>
    </div>

    <!-- Main -->
    <main class="container py-5">
      <!-- Header -->
      <div class="row g-4 align-items-center">
        <div class="col-lg-7">
          <h1 class="display-6 fw-bold mb-2">D — Denial of Service</h1>
          <p class="muted mb-0">
            Denial of Service is about making a service unavailable—by
            exhausting time, memory, bandwidth, or critical limits. Availability
            is the target.
          </p>
        </div>

        <!-- “image” (inline SVG) -->
        <div class="col-lg-5">
          <div class="card-glass p-3">
            <svg
              viewBox="0 0 640 220"
              class="w-100"
              role="img"
              aria-label="Denial of service illustration"
            >
              <defs>
                <linearGradient id="gD" x1="0" x2="1">
                  <stop
                    offset="0"
                    stop-color="var(--accent1)"
                    stop-opacity=".45"
                  />
                  <stop
                    offset="1"
                    stop-color="var(--accent2)"
                    stop-opacity=".25"
                  />
                </linearGradient>
                <filter id="glowD">
                  <feGaussianBlur stdDeviation="3" result="blur" />
                  <feMerge>
                    <feMergeNode in="blur" />
                    <feMergeNode in="SourceGraphic" />
                  </feMerge>
                </filter>
              </defs>

              <!-- background panel -->
              <rect
                x="10"
                y="10"
                width="620"
                height="200"
                rx="18"
                fill="url(#gD)"
                opacity=".35"
              />

              <!-- server box -->
              <rect
                x="395"
                y="55"
                width="205"
                height="120"
                rx="16"
                fill="#0b122055"
                stroke="#ffffff22"
              />
              <text
                x="420"
                y="92"
                fill="#eaf0ff"
                font-size="16"
                font-family="system-ui"
                font-weight="700"
              >
                Service
              </text>
              <rect
                x="420"
                y="110"
                width="155"
                height="12"
                rx="6"
                fill="#ffffff1f"
              />
              <rect
                x="420"
                y="132"
                width="125"
                height="12"
                rx="6"
                fill="#ffffff1f"
              />

              <!-- traffic lines -->
              <path
                d="M60 75 C170 75 260 75 370 95"
                stroke="var(--accent1)"
                stroke-width="6"
                stroke-linecap="round"
                opacity=".55"
              />
              <path
                d="M60 105 C175 105 260 105 370 115"
                stroke="var(--accent1)"
                stroke-width="6"
                stroke-linecap="round"
                opacity=".55"
              />
              <path
                d="M60 135 C180 135 265 135 370 135"
                stroke="var(--accent1)"
                stroke-width="6"
                stroke-linecap="round"
                opacity=".55"
              />
              <path
                d="M60 165 C175 165 260 165 370 155"
                stroke="var(--accent1)"
                stroke-width="6"
                stroke-linecap="round"
                opacity=".55"
              />

              <!-- warning / overload mark -->
              <path
                d="M505 78 L535 132"
                stroke="var(--accent2)"
                stroke-width="7"
                stroke-linecap="round"
                opacity=".9"
                filter="url(#glowD)"
              />
              <path
                d="M535 78 L505 132"
                stroke="var(--accent2)"
                stroke-width="7"
                stroke-linecap="round"
                opacity=".9"
                filter="url(#glowD)"
              />
              <text
                x="420"
                y="190"
                fill="#b8c4e3"
                font-size="13"
                font-family="system-ui"
              >
                Overloaded by Requests
              </text>
            </svg>
          </div>
        </div>
      </div>

      <!-- Info cards -->
      <div class="row g-4 mt-4">
        <div class="col-lg-4">
          <div class="card-glass p-4 h-100">
            <h2 class="h5 fw-semibold mb-2">What it means</h2>
            <p class="muted mb-0">
              Attackers overwhelm a service so legitimate users can’t access it.
            </p>
          </div>
        </div>

        <div class="col-lg-4">
          <div class="card-glass p-4 h-100">
            <h2 class="h5 fw-semibold mb-2">Why it matters</h2>
            <p class="muted mb-0">Downtime breaks trust and costs money.</p>
          </div>
        </div>

        <div class="col-lg-4">
          <div class="card-glass p-4 h-100">
            <h2 class="h5 fw-semibold mb-2">How to mitigate</h2>
            <p class="muted mb-0">
              Rate-limit, cache, queue work, scale horizontally.
            </p>
          </div>
        </div>
      </div>

      <!-- Lab -->
      <main class="container py-5">
        <section class="mt-5 card-glass p-4">
          <div class="d-flex justify-content-between align-items-start">
            <div>
              <h2 class="h4 fw-bold mb-1">Resource Pool Exhaustion</h2>
              <p class="muted mb-0">
                Clicks consume a limited server resource pool. Flood the system
                to exhaust it.
              </p>
            </div>
            <span class="badge badge-soft rounded-pill" id="lab1Status">
              Not solved
            </span>
          </div>

          <hr
            style="
              height: 1px;
              background: var(--stroke);
              opacity: 1;
              margin: 1.25rem 0;
            "
          />

          <div class="row g-4">
            <!-- Left: Status Panel -->
            <div class="col-lg-6">
              <div class="terminal-box p-3">
                <div class="d-flex justify-content-between">
                  <div>
                    <span class="muted">Service status:</span>
                    <span id="serviceStatus" class="fw-semibold">Healthy</span>
                  </div>
                  <div>
                    <span class="muted">Rate limit:</span>
                    <span id="rateLimitLabel" class="fw-semibold">OFF</span>
                  </div>
                </div>

                <div class="mt-2">
                  <span class="muted">Resource pool:</span>
                  <span id="poolLabel" class="fw-semibold"
                    >5000000 / 5000000</span
                  >
                </div>

                <div class="mt-1">
                  <span class="muted">Requests handled:</span>
                  <span id="clickLabel" class="fw-semibold">0</span>
                </div>

                <div class="mt-3">
                  <div
                    class="progress"
                    style="height: 10px; background: #ffffff12"
                  >
                    <div
                      id="poolBar"
                      class="progress-bar"
                      style="width: 100%"
                    ></div>
                  </div>
                </div>

                <div class="small muted mt-3">
                  Mission: Exhaust the pool (reach 0). Try manual clicks, then
                  try an automated flood.
                </div>
              </div>
            </div>

            <!-- Right: Controls + Instructions -->
            <div class="col-lg-6">
              <!-- Buttons -->
              <div class="d-flex gap-2 flex-wrap align-items-center">
                <button class="btn btn-primary btn-sm" id="attackBtn">
                  Send Request
                </button>

                <button class="btn btn-outline-light btn-sm" id="toggleRateBtn">
                  Toggle Rate Limiting
                </button>

                <button class="btn btn-outline-light btn-sm" id="resetBtn">
                  Reset Lab
                </button>
              </div>

              <div class="mt-3" id="lab1Result"></div>

              <!-- DevTools instructions -->
              <div class="alert alert-info mt-4 mb-0">
                <div class="fw-semibold">Attack instructions (DevTools)</div>
                <div class="small mt-1">Open DevTools → Console and run:</div>

                <pre
                  class="terminal-box p-3 mt-2 mb-0"
                ><code>// Flood the button with clicks (naive DoS)
const btn = document.getElementById("attackBtn");
for (let i = 0; i &lt; 50000; i++) btn.click();</code></pre>

                <div class="small muted mt-2">
                  Tip: Try it with rate limiting OFF vs ON.
                </div>
              </div>

              <!-- Hint -->
              <div class="alert alert-info mt-3 mb-0">
                <div class="fw-semibold">Hint</div>
                <div class="small">
                  “Attack scripts” are just loops that trigger many actions very
                  fast. Without protections, you can exhaust resources quickly.
                </div>
              </div>
            </div>
          </div>
        </section>
      </main>

      <!-- Lab 2 -->
      <main class="container py-5">
        <section class="mt-4 card-glass p-4">
          <div class="d-flex justify-content-between align-items-start">
            <div>
              <h2 class="h4 fw-bold mb-1">Slowloris (Connection Holding)</h2>
              <p class="muted mb-0">
                Instead of flooding, the attacker opens connections slowly and
                keeps them alive. The server runs out of connection slots.
              </p>
            </div>
            <span class="badge badge-soft rounded-pill" id="lab2Status"
              >Not solved</span
            >
          </div>

          <hr
            style="
              height: 1px;
              background: var(--stroke);
              opacity: 1;
              margin: 1.25rem 0;
            "
          />

          <div class="row g-4">
            <div class="col-lg-6">
              <div class="terminal-box p-3">
                <div class="d-flex justify-content-between">
                  <div>
                    <span class="muted">Server:</span>
                    <span id="slowServerStatus" class="fw-semibold"
                      >Healthy</span
                    >
                  </div>
                  <div>
                    <span class="muted">Idle timeout:</span>
                    <span id="slowTimeoutLabel" class="fw-semibold">ON</span>
                  </div>
                </div>

                <div class="mt-2">
                  <span class="muted">Open connections:</span>
                  <span id="slowOpenLabel" class="fw-semibold">0 / 50</span>
                </div>

                <div class="mt-1">
                  <span class="muted">Legit users blocked:</span>
                  <span id="slowBlockedLabel" class="fw-semibold">0</span>
                </div>

                <div class="mt-3">
                  <div
                    class="progress"
                    style="height: 10px; background: #ffffff12"
                  >
                    <div
                      id="slowBar"
                      class="progress-bar"
                      style="width: 0%"
                    ></div>
                  </div>
                </div>

                <div class="small muted mt-3">
                  Mission: Fill the server’s connection slots by keeping
                  connections open. Try with idle timeout ON vs OFF.
                </div>
              </div>
            </div>

            <div class="col-lg-6">
              <div class="d-flex gap-2 flex-wrap align-items-center">
                <button class="btn btn-primary btn-sm" id="openConnBtn">
                  Open 1 Connection
                </button>
                <button
                  class="btn btn-outline-light btn-sm"
                  id="toggleTimeoutBtn"
                >
                  Toggle Idle Timeout
                </button>
                <button class="btn btn-outline-light btn-sm" id="resetSlowBtn">
                  Reset Lab
                </button>
              </div>

              <div class="mt-3" id="lab2Result"></div>

              <div class="alert alert-info mt-4 mb-0">
                <div class="fw-semibold">Attack instructions (DevTools)</div>
                <div class="small mt-1">Open DevTools → Console and run:</div>

                <pre
                  class="terminal-box p-3 mt-2 mb-0"
                ><code>// Slowloris-style: open connections slowly and keep them alive
let opened = 0;
var t = setInterval(() => {
  document.getElementById("openConnBtn").click();
  opened++;
  if (opened >= 80) clearInterval(t); 
}, 200); // (change to lower value to overload)</code></pre>

                <div class="small muted mt-2">
                  Tip: If idle timeout is ON, the server closes idle
                  connections. If OFF, you can keep slots occupied much longer.
                </div>
              </div>
            </div>
          </div>
        </section>
      </main>

      <!-- Lab 3 -->
      <main class="container py-5">
        <section class="mt-4 card-glass p-4">
          <div class="d-flex justify-content-between align-items-start">
            <div>
              <h2 class="h4 fw-bold mb-1">Task 3 — JSON Bomb (Deep Nesting)</h2>
              <p class="muted mb-0">
                A valid JSON payload can still cause DoS if parsing/processing
                becomes expensive. Your job: send a payload that overwhelms the
                system.
              </p>
            </div>
            <span class="badge badge-soft rounded-pill" id="lab3Status"
              >Not solved</span
            >
          </div>

          <hr
            style="
              height: 1px;
              background: var(--stroke);
              opacity: 1;
              margin: 1.25rem 0;
            "
          />

          <div class="row g-4">
            <div class="col-lg-6">
              <div class="terminal-box p-3">
                <div class="d-flex justify-content-between">
                  <div>
                    <span class="muted">Processor:</span>
                    <span id="jsonStatus" class="fw-semibold">Idle</span>
                  </div>
                  <div>
                    <span class="muted">Depth limit:</span>
                    <span id="jsonLimitLabel" class="fw-semibold">ON</span>
                  </div>
                </div>

                <div class="mt-2">
                  <span class="muted">Detected depth:</span>
                  <span id="jsonDepthLabel" class="fw-semibold">0</span>
                </div>

                <div class="mt-1">
                  <span class="muted">Work units:</span>
                  <span id="jsonWorkLabel" class="fw-semibold">0</span>
                </div>

                <div class="small muted mt-3">
                  Mission: Submit a deeply nested JSON payload until the system
                  becomes “Degraded” or “Unresponsive”.
                </div>
              </div>
            </div>

            <div class="col-lg-6">
              <div class="d-flex gap-2 flex-wrap align-items-center">
                <button class="btn btn-primary btn-sm" id="jsonSubmitBtn">
                  Submit Payload
                </button>
                <button
                  class="btn btn-outline-light btn-sm"
                  id="toggleJsonLimitBtn"
                >
                  Toggle Depth Limit
                </button>
                <button class="btn btn-outline-light btn-sm" id="resetJsonBtn">
                  Reset Lab
                </button>
              </div>

              <div class="mt-3">
                <textarea
                  id="jsonInput"
                  class="form-control"
                  rows="6"
                  spellcheck="false"
                  placeholder='Paste JSON here. Example: {"a":{"a":{"a":{}}}}'
                ></textarea>
              </div>

              <div class="mt-3" id="lab3Result"></div>

              <div class="alert alert-info mt-4 mb-0">
                <div class="fw-semibold">Attack instructions (DevTools)</div>
                <div class="small mt-1">Open DevTools → Console and run:</div>

                <pre class="terminal-box p-3 mt-2 mb-0"><code>(() => {
  // Build nested JSON safely
  const depth = 250; // try 80, 150, 250...
  let obj = {};
  for (let i = 0; i < depth; i++) obj = { a: obj };

  const payload = JSON.stringify(obj);
  document.getElementById("jsonInput").value = payload;
  // then click "Submit Payload"
})();</code></pre>

                <div class="small muted mt-2">
                  Tip: This payload is valid JSON — but can still cause DoS if
                  the server processes it too deeply.
                </div>
              </div>
            </div>
          </div>
        </section>
      </main>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="logic.js"></script>
  </body>
</html>
