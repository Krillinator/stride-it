<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>E — Elevation of Privilege | STRIDE IT</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="index.css" />
    <!-- no e.css (you said you fixed CSS already) -->
  </head>

  <body>
    <div class="topbar sticky-top">
      <div
        class="container py-3 d-flex justify-content-between align-items-center"
      >
        <div class="fw-semibold">
          <a href="../index.html" class="brand-link">STRIDE IT</a>
        </div>

        <div class="d-flex gap-2 align-items-center">
          <span class="badge badge-soft rounded-pill" id="letterScore"
            >E: 0/3</span
          >
          <span class="badge badge-soft rounded-pill" id="totalScore"
            >Total: 0/18</span
          >
        </div>
      </div>
    </div>

    <main class="container py-5">
      <!-- Header -->
      <div class="row g-4 align-items-center">
        <div class="col-lg-7">
          <h1 class="display-6 fw-bold mb-2">E — Elevation of Privilege</h1>
          <p class="muted mb-0">
            Elevation of Privilege is when a user gains permissions they should
            not have. Authorization is the target.
          </p>
        </div>

        <!-- “image” (inline SVG) -->
        <div class="col-lg-5">
          <div class="card-glass p-3">
            <svg
              viewBox="0 0 640 220"
              class="w-100"
              role="img"
              aria-label="Elevation of privilege illustration"
            >
              <defs>
                <linearGradient id="gE" x1="0" x2="1">
                  <stop
                    offset="0"
                    stop-color="var(--accent1)"
                    stop-opacity=".45"
                  />
                  <stop
                    offset="1"
                    stop-color="var(--accent2)"
                    stop-opacity=".25"
                  />
                </linearGradient>
                <filter id="glowE">
                  <feGaussianBlur stdDeviation="3" result="blur" />
                  <feMerge>
                    <feMergeNode in="blur" />
                    <feMergeNode in="SourceGraphic" />
                  </feMerge>
                </filter>
              </defs>

              <!-- background panel -->
              <rect
                x="10"
                y="10"
                width="620"
                height="200"
                rx="18"
                fill="url(#gE)"
                opacity=".35"
              />

              <!-- Left: user -->
              <rect
                x="55"
                y="55"
                width="220"
                height="120"
                rx="16"
                fill="#0b122055"
                stroke="#ffffff22"
              />
              <text
                x="80"
                y="92"
                fill="#eaf0ff"
                font-size="16"
                font-family="system-ui"
                font-weight="700"
              >
                User
              </text>
              <rect
                x="80"
                y="110"
                width="160"
                height="12"
                rx="6"
                fill="#ffffff1f"
              />
              <text
                x="81"
                y="150"
                fill="#b8c4e3"
                font-size="13"
                font-family="system-ui"
              >
                Role: customer
              </text>

              <!-- Right: admin -->
              <rect
                x="365"
                y="55"
                width="220"
                height="120"
                rx="16"
                fill="#0b122055"
                stroke="#ffffff22"
              />
              <text
                x="390"
                y="92"
                fill="#eaf0ff"
                font-size="16"
                font-family="system-ui"
                font-weight="700"
              >
                Admin
              </text>
              <rect
                x="390"
                y="110"
                width="165"
                height="12"
                rx="6"
                fill="#ffffff1f"
              />
              <text
                x="391"
                y="150"
                fill="#b8c4e3"
                font-size="13"
                font-family="system-ui"
              >
                Role: admin
              </text>

              <!-- ladder / arrow up -->
              <path
                d="M300 165 L300 75"
                stroke="var(--accent1)"
                stroke-width="7"
                stroke-linecap="round"
                opacity=".75"
              />
              <path
                d="M288 92 L300 75 L312 92"
                fill="none"
                stroke="var(--accent1)"
                stroke-width="7"
                stroke-linecap="round"
                stroke-linejoin="round"
                opacity=".75"
              />

              <text
                x="245"
                y="195"
                fill="#b8c4e3"
                font-size="13"
                font-family="system-ui"
              >
                User becomes admin
              </text>
            </svg>
          </div>
        </div>
      </div>

      <!-- Three informational sections -->
      <div class="row g-4 mt-1">
        <div class="col-lg-4">
          <div class="card-glass p-4 h-100">
            <h2 class="h5 fw-semibold mb-2">What it means</h2>
            <p class="muted mb-0">
              A normal user reaches admin-only actions by abusing weak
              authorization, insecure defaults, or missing role checks.
            </p>
          </div>
        </div>

        <div class="col-lg-4">
          <div class="card-glass p-4 h-100">
            <h2 class="h5 fw-semibold mb-2">Why it matters</h2>
            <p class="muted mb-0">
              Once privileges increase, attackers can change settings, access
              other users’ data, or take over the entire system.
            </p>
          </div>
        </div>

        <div class="col-lg-4">
          <div class="card-glass p-4 h-100">
            <h2 class="h5 fw-semibold mb-2">How to mitigate</h2>
            <p class="muted mb-0">
              Enforce server-side authorization checks, follow least privilege,
              separate duties, and never trust roles coming from the client.
            </p>
          </div>
        </div>
      </div>

      <!-- Lab 1 -->
      <main class="container py-5">
        <section class="mt-5 card-glass p-4">
          <div class="d-flex justify-content-between align-items-start">
            <div>
              <h2 class="h4 fw-bold mb-1">Find the Roles & Endpoint</h2>
              <p class="muted mb-0">
                Elevation of Privilege often starts with discovery. Inspect the
                page source and find what roles exist — and the internal dev
                endpoint.
              </p>
            </div>
            <span class="badge badge-soft rounded-pill" id="lab1Status"
              >Not solved</span
            >
          </div>

          <hr
            style="
              height: 1px;
              background: var(--stroke);
              opacity: 1;
              margin: 1.25rem 0;
            "
          />

          <div class="row g-3">
            <div class="col-lg-7">
              <div class="terminal-box p-3">
                <div class="small muted">
                  Mission:
                  <ol class="mt-2 mb-0">
                    <li>Find the RBAC roles enum (3 roles).</li>
                    <li>Find the internal endpoint path.</li>
                  </ol>
                </div>
              </div>
            </div>

            <div class="col-lg-5">
              <div class="d-grid gap-2">
                <input
                  id="rolesInput"
                  class="form-control form-control-sm"
                  type="text"
                  placeholder="Enter roles (comma-separated)"
                />

                <input
                  id="endpointInput"
                  class="form-control form-control-sm"
                  type="text"
                  placeholder="Enter endpoint path (e.g. /internal/...)"
                />

                <button class="btn btn-primary btn-sm" id="checkBtn">
                  Submit
                </button>
              </div>

              <div class="mt-3" id="lab1Result"></div>

              <div class="alert alert-info mt-3 mb-0">
                <div class="fw-semibold">Hint</div>
                <div class="small">Network & Requests tabs</div>
              </div>
            </div>
          </div>
        </section>
      </main>

      <!-- Lab 2 -->
      <main class="container py-5">
        <section class="mt-5 card-glass p-4">
          <div class="d-flex justify-content-between align-items-start">
            <div>
              <h2 class="h4 fw-bold mb-1">Network Status Code</h2>
              <p class="muted mb-0">
                Open DevTools → Network tab. Visit <code>/internal</code>. What
                HTTP status code do you see?
              </p>
            </div>
            <span class="badge badge-soft rounded-pill" id="lab2Status">
              Not solved
            </span>
          </div>

          <hr
            style="
              height: 1px;
              background: var(--stroke);
              opacity: 1;
              margin: 1.25rem 0;
            "
          />

          <div class="row g-3">
            <div class="col-lg-6">
              <input
                id="statusCodeInput"
                class="form-control form-control-sm"
                type="text"
                placeholder="Enter HTTP status code"
              />
            </div>

            <div class="col-lg-6">
              <button class="btn btn-primary btn-sm" id="checkStatusBtn">
                Submit
              </button>
            </div>
          </div>

          <div class="mt-3" id="lab2Result"></div>
        </section>
      </main>
    </main>

    <!-- Lab 3 -->
    <main class="container py-5">
      <section class="mt-5 card-glass p-4">
        <div class="d-flex justify-content-between align-items-start">
          <div>
            <h2 class="h4 fw-bold mb-1">Final Check</h2>
            <p class="muted mb-0"><code>/internal</code> — did you miss it?</p>
          </div>
          <span class="badge badge-soft rounded-pill" id="lab3Status">
            Not solved
          </span>
        </div>

        <hr
          style="
            height: 1px;
            background: var(--stroke);
            opacity: 1;
            margin: 1.25rem 0;
          "
        />

        <div class="row g-3">
          <div class="col-lg-8">
            <input
              id="finalInput"
              class="form-control form-control-sm"
              type="text"
              placeholder="Enter value"
            />
          </div>

          <div class="col-lg-4">
            <button class="btn btn-primary btn-sm" id="checkFinalBtn">
              Submit
            </button>
          </div>
        </div>

        <div class="mt-3" id="lab3Result"></div>
      </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="logic.js"></script>
  </body>
</html>
