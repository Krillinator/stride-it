<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>STRIDE IT</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="landing.css" />
  </head>

  <body>
    <div class="topbar sticky-top">
      <div
        class="container py-3 d-flex align-items-center justify-content-between"
      >
        <div class="d-flex align-items-center">
          <span class="brand-dot"></span>
          <div class="fw-semibold">
            <a href="#" class="brand-link">STRIDE IT</a>
          </div>
        </div>

        <div class="d-flex align-items-center gap-3">
          <a href="intro/index.html" class="brand-link"
            >Confused? Begin here!</a
          >

          <a
            href="https://github.com/krillinator"
            target="_blank"
            class="github-link"
            aria-label="GitHub repository"
          >
            <span class="github-text">Krillinator</span>
            <i class="bi bi-github github-icon"></i>
          </a>
        </div>
      </div>
    </div>

    <!-- First visit modal -->
    <div
      class="modal fade"
      id="firstVisitModal"
      tabindex="-1"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content first-visit-modal">
          <div class="modal-header border-0 pb-0">
            <h5 class="modal-title fw-bold">Welcome to STRIDE IT!</h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>

          <div class="modal-body pt-2">
            <p class="mb-2" style="color: var(--muted)">
              Hi there, are you new around here? Would you like a beginners
              walkthrough?
            </p>

            <div class="d-grid gap-2 pt-4">
              <a
                class="btn btn-primary"
                href="intro/index.html"
                onclick="
                  if (document.getElementById('dontShowAgain')?.checked) {
                    localStorage.setItem('stride_hide_welcome_v1', 'true')
                  }
                  localStorage.setItem('stride_first_visit_v1', '1')
                "
              >
                Yes, i'm new
              </a>
            </div>

            <div class="form-check mt-3">
              <input
                class="form-check-input"
                type="checkbox"
                id="dontShowAgain"
              />
              <label class="form-check-label" for="dontShowAgain">
                Don’t show this again
              </label>
            </div>
          </div>
        </div>
      </div>
    </div>

    <main class="container hero">
      <div class="row align-items-end g-4">
        <div class="col-lg-7">
          <h1 class="display-5 fw-bold mb-3">
            Learn <span class="grad-stride">STRIDE</span> interactively.
          </h1>
          <p class="sub mb-0">
            Each letter contains short scenarios, quick checks, and mitigation
            thinking.
          </p>
        </div>

        <a href="about/index.html" class="col-lg-5 text-decoration-none">
          <div class="hint">
            <div class="fw-semibold mb-1">Why?</div>
            <div class="small">
              Don't react, anticipate. <br />
              Prevent problems before they occur through Threat Modelling
            </div>
          </div>
        </a>
      </div>

      <div class="mt-4 mt-lg-5 stride-grid">
        <!-- S -->
        <a
          class="stride-tile"
          href="s/index.html"
          aria-label="Spoofing"
          data-letter="S"
        >
          <div class="tile-header">
            <div class="stride-letter"><span class="main">S</span></div>
            <span class="badge badge-soft rounded-pill" data-role="tileScore"
              >S: 0/3</span
            >
          </div>

          <div class="stride-title">Spoofing</div>
          <p class="stride-desc">
            Identity deception: pretending to be someone/something else.
          </p>
          <i
            class="bi bi-arrow-right-short stride-arrow"
            aria-hidden="true"
          ></i>
        </a>

        <!-- T -->
        <a
          class="stride-tile"
          href="t/index.html"
          aria-label="Tampering"
          data-letter="T"
        >
          <div class="tile-header">
            <div class="stride-letter"><span class="main">T</span></div>
            <span class="badge badge-soft rounded-pill" data-role="tileScore"
              >T: 0/3</span
            >
          </div>

          <div class="stride-title">Tampering</div>
          <p class="stride-desc">
            Unauthorized modification of data, code, or configuration.
          </p>
          <i
            class="bi bi-arrow-right-short stride-arrow"
            aria-hidden="true"
          ></i>
        </a>

        <!-- R -->
        <a
          class="stride-tile"
          href="r/index.html"
          aria-label="Repudiation"
          data-letter="R"
        >
          <div class="tile-header">
            <div class="stride-letter"><span class="main">R</span></div>
            <span class="badge badge-soft rounded-pill" data-role="tileScore"
              >R: 0/3</span
            >
          </div>

          <div class="stride-title">Repudiation</div>
          <p class="stride-desc">
            “It wasn’t me”: missing proof, logging, or traceability.
          </p>
          <i
            class="bi bi-arrow-right-short stride-arrow"
            aria-hidden="true"
          ></i>
        </a>

        <!-- I -->
        <a
          class="stride-tile"
          href="i/index.html"
          aria-label="Information Disclosure"
          data-letter="I"
        >
          <div class="tile-header">
            <div class="stride-letter"><span class="main">I</span></div>
            <span class="badge badge-soft rounded-pill" data-role="tileScore"
              >I: 0/3</span
            >
          </div>

          <div class="stride-title">Information Disclosure</div>
          <p class="stride-desc">
            Data exposure: leaks, over-sharing, weak access control.
          </p>
          <i
            class="bi bi-arrow-right-short stride-arrow"
            aria-hidden="true"
          ></i>
        </a>

        <!-- D -->
        <a
          class="stride-tile"
          href="d/index.html"
          aria-label="Denial of Service"
          data-letter="D"
        >
          <div class="tile-header">
            <div class="stride-letter"><span class="main">D</span></div>
            <span class="badge badge-soft rounded-pill" data-role="tileScore"
              >D: 0/3</span
            >
          </div>

          <div class="stride-title">Denial of Service</div>
          <p class="stride-desc">
            Availability attacks: slow, crash, block, exhaust resources.
          </p>
          <i
            class="bi bi-arrow-right-short stride-arrow"
            aria-hidden="true"
          ></i>
        </a>

        <!-- E -->
        <a
          class="stride-tile"
          href="e/index.html"
          aria-label="Elevation of Privilege"
          data-letter="E"
        >
          <div class="tile-header">
            <div class="stride-letter"><span class="main">E</span></div>
            <span class="badge badge-soft rounded-pill" data-role="tileScore"
              >E: 0/3</span
            >
          </div>

          <div class="stride-title">Elevation of Privilege</div>
          <p class="stride-desc">
            Gaining permissions you shouldn’t have (user → admin).
          </p>
          <i
            class="bi bi-arrow-right-short stride-arrow"
            aria-hidden="true"
          ></i>
        </a>
      </div>

      <div class="mt-4 small" style="color: var(--muted)">
        An interactive website to better understand STRIDE
      </div>

      <a
        href="/stride-it/CIA/index.html"
        class="bonus-box text-decoration-none"
        aria-label="CIA Triad drag and drop"
      >
        <div class="d-flex align-items-start justify-content-between gap-3">
          <div>
            <div class="bonus-title">
              <i class="bi bi-shield-lock me-2"></i>
              Threat Mapping with CIA-Triad
            </div>
            <div class="bonus-desc">
              Drag STRIDE threats into the CIA pillars. The “correct” answer is
              the reasoning.
            </div>
          </div>
          <div class="bonus-cta">
            Open <i class="bi bi-arrow-right-short"></i>
          </div>
        </div>
      </a>

      <!-- Score -->
      <div class="score-bar">
        <span class="score-label">Progress</span>
        <span class="score-value" id="total-score">0 / 18</span>
      </div>

      <!-- Progress bar -->
      <div
        class="progress score-progress"
        role="progressbar"
        aria-label="Overall progress"
      >
        <div
          id="score-progress-bar"
          class="progress-bar"
          style="width: 0%"
          aria-valuemin="0"
          aria-valuemax="18"
          aria-valuenow="0"
        ></div>
      </div>

      <!-- Start over-->
      <div class="row g-3 mt-3">
        <div class="col-md-2 d-grid">
          <button
            class="btn btn-primary"
            onclick="
              if (confirm('Are you sure you want to start over?')) {
                localStorage.removeItem('stride_progress_v1')
                localStorage.removeItem('stride_first_visit_v1')
                localStorage.removeItem('stride_hide_welcome_v1')
                location.reload()
              }
            "
          >
            Start Over
          </button>
        </div>
      </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script type="module">
      import {
        loadProgress,
        getLetterScore,
        getTotalScore,
        getCompletionHint,
      } from "./progress.js"

      loadProgress()

      // First visit modal logic (optional)
      const FIRST_VISIT_KEY = "stride_first_visit_v1"
      const HIDE_WELCOME_KEY = "stride_hide_welcome_v1"
      const isFirstVisit = !localStorage.getItem(FIRST_VISIT_KEY)
      const hideWelcome = localStorage.getItem(HIDE_WELCOME_KEY) === "true"

      if (isFirstVisit && !hideWelcome) {
        const modalEl = document.getElementById("firstVisitModal")
        if (modalEl) {
          new bootstrap.Modal(modalEl).show()
        }
      }

      const total = getTotalScore()
      const max = 18

      const scoreEl = document.getElementById("total-score")
      scoreEl.textContent = `${total} / ${max}`

      const progressBarEl = document.getElementById("score-progress-bar")
      if (progressBarEl) {
        const pct = Math.max(0, Math.min(100, (total / max) * 100))
        progressBarEl.style.width = `${pct}%`
        progressBarEl.setAttribute("aria-valuenow", String(total))
      }

      // Update each tile pill
      document.querySelectorAll(".stride-tile[data-letter]").forEach((tile) => {
        const letter = tile.dataset.letter
        const score = getLetterScore(letter) // 0..3

        const pill = tile.querySelector('[data-role="tileScore"]')
        if (pill) {
          pill.textContent = `${letter}: ${score}/3`
          pill.classList.toggle("is-done", score === 3)
        }
      })

      // Secret hint
      const hint = getCompletionHint()
      if (hint) {
        const secret = document.createElement("div")
        secret.className = "mt-3 small text-center opacity-25"
        secret.style.letterSpacing = "2px"
        secret.textContent = JSON.stringify(hint)
        document.querySelector("main").appendChild(secret)
      }
    </script>
  </body>
</html>
